machine:
  files:
    - content: |
        [metrics]
          address = "0.0.0.0:11234"
      path: /etc/cri/conf.d/20-metrics.part
      op: create
  nodeLabels:
    openebs.io/engine: mayastor
  sysctls:
    net.ipv4.ip_forward: "1"
    net.bridge.bridge-nf-call-iptables: "1"
    net.bridge.bridge-nf-call-ip6tables: "1"
    vm.nr_hugepages: "2048"
  install:
    disk: /dev/sda
    image: ghcr.io/usa-reddragon/talos-installer:v1.6.0-alpha.0-53-ge99d288b5@ sha256:ffc367873e057bd0f664115c61af92900d8559b092062341f01830ac690500bc
    extensions:
    - image: ghcr.io/siderolabs/amd-ucode:20230804@sha256:845a76c546837f19eca1c6c8aaff4a26fcbaca9e46028dede5321b372106927a
    - image: ghcr.io/siderolabs/amdgpu-firmware:20230804@sha256:92ce0e3df9c48947b167018ccafa478363bde1e902ec1a2c0f0d5b011339e15b
    wipe: true
    bootloader: true
  kernel:
    modules:
    - name: nvme-tcp
    - name: overlay
    - name: br_netfilter
    - name: iptable_raw
    - name: ip6_tables
  sysfs:
    devices.system.cpu.cpu0.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu1.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu2.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu3.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu4.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu5.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu6.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu7.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu8.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu9.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu10.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu11.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu12.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu13.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu14.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu15.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu16.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu17.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu18.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu19.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu20.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu21.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu22.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu23.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu24.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu25.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu26.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu27.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu28.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu29.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu30.cpufreq.scaling_governor: performance
    devices.system.cpu.cpu31.cpufreq.scaling_governor: performance
  network:
    interfaces:
    - interface: bond0
      dhcp: true
      bond:
        deviceSelectors:
        - hardwareAddr: '00:0F:53:*'
        mode: 802.3ad
        lacpRate: fast

    # # Machine system disk encryption configuration.
    # systemDiskEncryption:
    #     # Ephemeral partition encryption.
    #     ephemeral:
    #         provider: luks2 # Encryption provider to use for the encryption.
    #         # Defines the encryption keys generation and storage method.
    #         keys:
    #             - # Deterministically generated key from the node UUID and PartitionLabel.
    #               nodeID: {}
    #               slot: 0 # Key slot number for LUKS2 encryption.
    #               
    #               # # KMS managed encryption key.
    #               # kms:
    #               #     endpoint: https://192.168.88.21:4443 # KMS endpoint to Seal/Unseal the key.
    #         
    #         # # Cipher kind to use for the encryption. Depends on the encryption provider.
    #         # cipher: aes-xts-plain64

    #         # # Defines the encryption sector size.
    #         # blockSize: 4096

    #         # # Additional --perf parameters for the LUKS2 encryption.
    #         # options:
    #         #     - no_read_workqueue
    #         #     - no_write_workqueue
cluster:
  allowSchedulingOnControlPlanes: true
  network:
    podSubnets:
    - 172.17.0.0/16
    serviceSubnets:
    - 172.18.0.0/16
    cni:
      name: custom
      urls:
      - https://raw.githubusercontent.com/projectcalico/calico/v3.26.1/manifests/tigera-operator.yaml
      - https://raw.githubusercontent.com/USA-RedDragon/talos-configs/main/calico.yaml
  apiServer:
    certSANs:
    - api.k8s.mcswain.dev
    - alpha.k8s.mcswain.dev
    - beta.k8s.mcswain.dev
    - gamma.k8s.mcswain.dev
    - 192.168.1.254
    - 192.168.1.253
    - 192.168.1.252
    admissionControl:
    - name: NamespaceLifecycle
    - name: LimitRanger
    - name: ServiceAccount
    - name: DefaultStorageClass
    - name: DefaultTolerationSeconds
    - name: MutatingAdmissionWebhook
    - name: ValidatingAdmissionWebhook
    - name: ResourceQuota
